<div class="mega-menu">
  <div class="mega-menu__inner page-width">

    {% for block in section.blocks %}
      {% case block.type %}

      {% when 'menu_column' %}
        <div class="mega-menu__column" {{ block.shopify_attributes }}>
          <h4>{{ block.settings.heading }}</h4>

          {% if block.settings.menu != blank %}
            {% for link in block.settings.menu.links %}
              <a href="{{ link.url }}">{{ link.title }}</a>
            {% endfor %}
          {% endif %}
        </div>

      {% when 'mega_image' %}
        <div class="mega-menu__image" {{ block.shopify_attributes }}>
          {% if block.settings.image != blank %}
            <img
              src="{{ block.settings.image | image_url: width: 300 }}"
              alt="{{ block.settings.image.alt | escape }}"
              width="300"
              height="{{ 300 | divided_by: block.settings.image.aspect_ratio | round }}"
            >
          {% endif %}

          <p>{{ block.settings.caption }}</p>
        </div>

      {% endcase %}
    {% endfor %}

  </div>
</div>


{% schema %}
{
  "name": "Everlane Header",
  "blocks": [
    {
      "type": "menu_column",
      "name": "Mega menu column",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Featured"
        },
        {
          "type": "link_list",
          "id": "menu",
          "label": "Menu"
        }
      ]
    },
    {
      "type": "mega_image",
      "name": "Mega menu image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "caption",
          "label": "Caption",
          "default": "SHOP COLLECTION"
        }
      ]
    }
  ],
  "max_blocks": 8
}
{% endschema %}
